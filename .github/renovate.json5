{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  // ============================================================================
  // Base Configuration
  // ============================================================================
  extends: ["config:recommended", ":semanticCommits"],

  // Timezone for scheduling
  timezone: "America/Los_Angeles",

  // Create PRs immediately (override default schedule)
  schedule: ["at any time"],

  // Disable rate limiting
  prHourlyLimit: 0,
  prConcurrentLimit: 0,

  // Branch naming
  branchPrefix: "deps/",

  // ============================================================================
  // Package Managers
  // ============================================================================
  // Enable Python package managers for backend/pyproject.toml
  // The pep621 manager handles pyproject.toml with [project] section
  enabledManagers: ["pep621", "npm", "github-actions"],

  // ============================================================================
  // Commit & PR Title Format
  // ============================================================================
  // When auto-merge uses squash, the PR title becomes the commit message.
  // Both must follow conventional commits format for commitlint to pass.
  commitMessagePrefix: "chore(deps):",
  commitMessageAction: "update",
  prTitle: "chore(deps): update {{{depName}}} to {{{newVersion}}}",

  // Prevent long release notes in commit body (avoids commitlint failures)
  commitBody: "",
  commitBodyTable: false,

  // ============================================================================
  // Labels & Dashboard
  // ============================================================================
  labels: ["dependencies", "renovate", "automerge"],
  dependencyDashboard: true,
  dependencyDashboardTitle: "游닍 Renovate Dependency Dashboard",
  dependencyDashboardAutoclose: true,
  dependencyDashboardApproval: false,

  // Allow recreating closed PRs
  recreateWhen: "auto",

  // PR body template
  prBodyTemplate: "{{{header}}}{{{table}}}{{{warnings}}}{{{notes}}}{{{changelogs}}}{{{controls}}}{{{footer}}}",
  fetchChangeLogs: "pr",

  // ============================================================================
  // Package Rules
  // ============================================================================
  packageRules: [
    // ==========================================================================
    // 游리 Python dependencies: Group minor/patch updates
    // ==========================================================================
    {
      matchManagers: ["pep621", "poetry", "pip_requirements", "pip-compile"],
      matchUpdateTypes: ["minor", "patch"],
      groupName: "python-minor-patch",
      description: "Python minor/patch updates (auto-merge)",
      automerge: true,
      automergeType: "pr",
      automergeStrategy: "squash",
      commitMessagePrefix: "chore(deps-python):",
      prTitle: "chore(deps-python): update python dependencies",
    },

    // ==========================================================================
    // 游리 Node.js dependencies: Group minor/patch updates
    // ==========================================================================
    {
      matchManagers: ["npm"],
      matchUpdateTypes: ["minor", "patch"],
      groupName: "npm-minor-patch",
      description: "npm minor/patch updates (auto-merge)",
      automerge: true,
      automergeType: "pr",
      automergeStrategy: "squash",
      commitMessagePrefix: "chore(deps-npm):",
      prTitle: "chore(deps-npm): update npm dependencies",
    },

    // ==========================================================================
    // 游릭 GitHub Actions: Auto-merge minor/patch updates
    // ==========================================================================
    {
      matchManagers: ["github-actions"],
      matchUpdateTypes: ["minor", "patch"],
      groupName: "github-actions",
      description: "GitHub Actions minor/patch updates (auto-merge)",
      automerge: true,
      automergeType: "pr",
      automergeStrategy: "squash",
      commitMessagePrefix: "chore(deps-actions):",
      prTitle: "chore(deps-actions): update github actions",
    },

    // ==========================================================================
    // 游댯 Major updates: Require review (except eero packages)
    // ==========================================================================
    {
      matchUpdateTypes: ["major"],
      excludePackageNames: ["eero-api", "eero-prometheus-exporter"],
      description: "Major updates require manual review",
      automerge: false,
      addLabels: ["major-update", "needs-review"],
      reviewers: ["fulviofreitas"],
      commitMessagePrefix: "chore(deps-major):",
      prTitle: "chore(deps-major): update {{{depName}}} to {{{newVersion}}}",
    },

    // ==========================================================================
    // 游릮 Security updates: High priority
    // ==========================================================================
    {
      matchDepTypes: ["devDependencies", "dependencies"],
      matchUpdateTypes: ["patch"],
      matchPackageNames: ["*"],
      prPriority: 20,
      description: "Security patches get high priority",
    },

    // ==========================================================================
    // 游릭 eero packages - Internal dependencies (MUST BE LAST to override major rule)
    // ==========================================================================
    // eero-api and eero-prometheus-exporter must be updated together because
    // eero-prometheus-exporter pins eero-api to a specific version.
    // Updates trigger minor version bump via feat(deps): prefix.
    // This rule is placed LAST so it takes precedence over the major updates rule.
    {
      matchPackageNames: ["eero-api", "eero-prometheus-exporter"],
      matchManagers: ["pep621", "poetry", "pip_requirements", "pip-compile"],
      groupName: "eero-packages",
      description: "游릭 eero packages update (triggers minor release)",
      automerge: true,
      automergeType: "pr",
      automergeStrategy: "squash",
      addLabels: ["eero-packages", "feature", "critical"],
      prPriority: 10,
      commitMessagePrefix: "feat(deps):",
      prTitle: "feat(deps): update eero packages",
      prBodyNotes: [
        "## 游릭 eero Packages Update",
        "",
        "This PR updates the eero ecosystem packages:",
        "- `eero-api` - Core API client for eero network communication",
        "- `eero-prometheus-exporter` - Embedded Prometheus metrics exporter",
        "",
        "**Note**: These packages are grouped because `eero-prometheus-exporter` depends on a specific version of `eero-api`.",
        "",
        "### Links",
        "- [eero-api on PyPI](https://pypi.org/project/eero-api/)",
        "- [eero-prometheus-exporter on PyPI](https://pypi.org/project/eero-prometheus-exporter/)",
      ],
    },
  ],

  // Vulnerability alerts
  vulnerabilityAlerts: {
    enabled: true,
    labels: ["security", "critical", "automerge"],
    automerge: true,
  },
}
